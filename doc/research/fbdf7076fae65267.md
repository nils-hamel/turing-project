## Training and generalisation of the inv-hsv-osi-l2 according to the data-set and hidden size

This study focus on the analysis of the generalisation and training performance of the 
[inv-hsv-osi-l2](https://github.com/nils-hamel/turing-project/tree/master/src/turing-auto/auto-inv-hsv-osi-l2)
auto-encoder according to the considered data-set and to the size of its unique
hidden layer. For each considered data-set, the size of the hidden layer is
modulated and the evolution of the training and validation losses are analysed. In
addition, auto-encoded images are used to illustrate the training and generalisation
performance of the neural network.

Neural network [page and code](https://github.com/nils-hamel/turing-project/blob/master/src/turing-auto/auto-inv-hsv-osi-l2

## Network topology and training

This research considers the inv-hsv-osi-l2 single-layer auto-encoder in order to
analyse its ability to generalise according to the considered data-set and the
size of its hidden layer.

The auto-encoder consists then in three layers : the input layer that have its
size corresponding to the amount of the image pixel; the hidden layer that is
modulated in size; and the output layer that has the same size as the input
layer. Both hidden and output layers have sigmoid as activation function.

The auto-encoder is trained based on the cost function that is a L2 norm
between the input and output layer. The cost function is then zero as the input
and output layer are strictly equal.

For each of the considered data-set, the size of the hidden layer is modulated
with the following values : 64, 128, 256, 512, 1024 and 2048. The data-sets are
split in two part : the training part and the validation part. Usually, eighty
percents of the data-set is used for training. At each epoch, the objective
function is exported for both training (last batch) and validation sub-sets.

For this research, the network is trained on all data-set and for all of the
selected hidden layer size. The number of training epochs is always 256.

## Training and validation loss

The following plots shows the evolution of the training and validation
loss according to the considered data-set and the size of the unique hidden
layer of the auto-encoder.

On each plots, the training and validation loss are presented according to the
epochs of the network training for each size of the hidden layer and for each
data-set. The red curve shows the evolution of the training loss while the orange
curve shows the evolution of the validation loss.

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2009-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2009.md">64x64x3-geneva-2009</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2011-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2011.md">64x64x3-geneva-2011</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2016-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2016.md">64x64x3-geneva-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-oblique-2013-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-oblique-2013.md">64x64x3-geneva-oblique-2013</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-paris-louvre-2017-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-paris-louvre-2017.md">64x64x3-paris-louvre-2017</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2004-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2004.md">64x64x3-venezia-2004</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2010-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2010.md">64x64x3-venezia-2010</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2014-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2014.md">64x64x3-venezia-2014</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-campanile-2016-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-campanile-2016.md">64x64x3-venezia-campanile-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-palazzo-ducale-2016-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-palazzo-ducale-2016.md">64x64x3-venezia-palazzo-ducale-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-piazza-2016-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-piazza-2016.md">64x64x3-venezia-piazza-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-san-giacometto-2016-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-san-giacometto-2016.md">64x64x3-venezia-san-giacometto-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-san-marco-2016-loss.png?raw=true" width="640"><br />
<i>Training (red) and validation (orange) loss according to training epochs for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-san-marco-2016.md">64x64x3-venezia-san-marco-2016</a> data-set</i>
</p>

## Training and validation auto-encoded examples

The following plots show, for each data-sets, an illustration of the auto-encoding
process according to the size of the network hidden layer performed on sampling of
the training and validation set. The selected image of the training and validation
sets are sent in the trained network and the output image is kept. The following
plots shows, for each example, both original and auto-encoded images.

For each data-set, two plots are computed : the training and the validation plots.
On each plot, groups of 24 couple of original and auto-encoded images are presented
for each size of the hidden layer. From top to bottom, the groups corresponds to
64, 128, 256, 512, 1024 and 2048 hidden layer size.

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2009-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2009.md">64x64x3-geneva-2009</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2009-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2009.md">64x64x3-geneva-2009</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2011-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2011.md">64x64x3-geneva-2011</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2011-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2011.md">64x64x3-geneva-2011</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2016-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2016.md">64x64x3-geneva-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-2016-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-2016.md">64x64x3-geneva-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-oblique-2013-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-oblique-2013.md">64x64x3-geneva-oblique-2013</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-geneva-oblique-2013-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-geneva-oblique-2013.md">64x64x3-geneva-oblique-2013</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-paris-louvre-2017-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-paris-louvre-2017.md">64x64x3-paris-louvre-2017</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-paris-louvre-2017-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-paris-louvre-2017.md">64x64x3-paris-louvre-2017</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2004-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2004.md">64x64x3-venezia-2004</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2004-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2004.md">64x64x3-venezia-2004</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2010-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2010.md">64x64x3-venezia-2010</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2010-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2010.md">64x64x3-venezia-2010</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2014-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2014.md">64x64x3-venezia-2014</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-2014-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-2014.md">64x64x3-venezia-2014</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-campanile-2016-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-campanile-2016.md">64x64x3-venezia-campanile-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-campanile-2016-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-campanile-2016.md">64x64x3-venezia-campanile-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-palazzo-ducale-2016-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-palazzo-ducale-2016.md">64x64x3-venezia-palazzo-ducale-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-palazzo-ducale-2016-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-palazzo-ducale-2016.md">64x64x3-venezia-palazzo-ducale-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-piazza-2016-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-piazza-2016.md">64x64x3-venezia-piazza-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-piazza-2016-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-piazza-2016.md">64x64x3-venezia-piazza-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-san-giacometto-2016-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-san-giacometto-2016.md">64x64x3-venezia-san-giacometto-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-san-giacometto-2016-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-san-giacometto-2016.md">64x64x3-venezia-san-giacometto-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-san-marco-2016-train.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the training set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-san-marco-2016.md">64x64x3-venezia-san-marco-2016</a> data-set</i>
</p>

<p align="center">
<img src="https://github.com/nils-hamel/turing-project/blob/master/doc/research/fbdf7076fae65267/64x64x3-venezia-san-marco-2016-valid.jpg?raw=true" width="600">
<br />
<i>Auto-encoding on the validation set for the <a href="https://github.com/nils-hamel/turing-project/blob/master/doc/dataset/64x64x3-venezia-san-marco-2016.md">64x64x3-venezia-san-marco-2016</a> data-set</i>
</p>

